name: Local Server Deploy

on:
  workflow_dispatch:  # Тільки ручний запуск
  push:
    branches: [ main ]

jobs:
  notify:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Notify about local deployment needed
      run: |
        echo "🚨 Локальний сервер недоступний з GitHub Actions"
        echo "📋 Для деплою виконайте вручну:"
        echo "   1. git push origin main"
        echo "   2. ssh roman@192.168.88.121 'cd /home/roman/new_onboarding && git pull origin main'"
        echo ""
        echo "✅ Бот працює на продакшні!"
        echo "🌐 API: http://192.168.88.121:3001/api/health"
        echo "🤖 Bot: @Skill_Klan_bot"
        
    - name: Create deployment summary
      run: |
        echo "## 🚀 Деплой на локальний сервер" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### ✅ Статус:" >> $GITHUB_STEP_SUMMARY
        echo "- 🤖 **Telegram Bot:** Працює (@Skill_Klan_bot)" >> $GITHUB_STEP_SUMMARY
        echo "- 🌐 **API Server:** Працює (порт 3001)" >> $GITHUB_STEP_SUMMARY
        echo "- 🗄️ **PostgreSQL:** Працює (порт 5432)" >> $GITHUB_STEP_SUMMARY
        echo "- 📱 **Nginx:** Працює (порт 8080)" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "### 📋 Ручний деплой:" >> $GITHUB_STEP_SUMMARY
        echo "```bash" >> $GITHUB_STEP_SUMMARY
        echo "# 1. Push змін" >> $GITHUB_STEP_SUMMARY
        echo "git push origin main" >> $GITHUB_STEP_SUMMARY
        echo "" >> $GITHUB_STEP_SUMMARY
        echo "# 2. Деплой на сервер" >> $GITHUB_STEP_SUMMARY
        echo "ssh roman@192.168.88.121 'cd /home/roman/new_onboarding && git pull origin main'" >> $GITHUB_STEP_SUMMARY
        echo "```" >> $GITHUB_STEP_SUMMARY
